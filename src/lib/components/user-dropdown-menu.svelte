<script lang="ts">
  import * as DropdownMenu from "$lib/components/ui/dropdown-menu/index.js"
  import { Button } from "$lib/components/ui/button/index.js"
  import ActiveLink from "./active-link.svelte"
  import { localizeHref } from "../paraglide/runtime"
  import { m } from "$lib/paraglide/messages"
</script>

<DropdownMenu.Root>
  <DropdownMenu.Trigger>
    {#snippet child({ props })}
      <Button
        {...props}
        class="bg-brand-primary size-12 !p-0 flex items-center justify-center rounded-full p-0"
        variant="ghost"
      >
        <span class="sr-only">{m.navbar_account()}</span>
        <span class="size-5">
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
            class="w-full h-full"
          >
            <path
              d="M12 0.5C13.525 0.5 14.9875 1.1058 16.0659 2.18414C17.1442 3.26247 17.75 4.72501 17.75 6.25C17.75 7.77499 17.1442 9.23753 16.0659 10.3159C14.9875 11.3942 13.525 12 12 12C10.475 12 9.01247 11.3942 7.93414 10.3159C6.8558 9.23753 6.25 7.77499 6.25 6.25C6.25 4.72501 6.8558 3.26247 7.93414 2.18414C9.01247 1.1058 10.475 0.5 12 0.5ZM12 14.875C18.3538 14.875 23.5 17.4481 23.5 20.625V23.5H0.5V20.625C0.5 17.4481 5.64625 14.875 12 14.875Z"
              fill="white"
            />
          </svg>
        </span>
      </Button>
    {/snippet}
  </DropdownMenu.Trigger>
  <DropdownMenu.Content class="w-56 bg-white" align="end">
    <DropdownMenu.Item>
      <ActiveLink
        href={localizeHref("/profile")}
        className="flex items-center gap-2 w-full"
        shouldHaveActiveState={false}
      >
        <span>
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M15 5.9997L18 8.9997M13 19.9997H21M5 15.9997L4 19.9997L8 18.9997L19.586 7.4137C19.9609 7.03864 20.1716 6.53003 20.1716 5.9997C20.1716 5.46937 19.9609 4.96075 19.586 4.5857L19.414 4.4137C19.0389 4.03876 18.5303 3.82812 18 3.82812C17.4697 3.82813 16.9611 4.03876 16.586 4.4137L5 15.9997Z"
              stroke="black"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            />
          </svg>
        </span>

        {m.navbar_profile()}</ActiveLink
      >
    </DropdownMenu.Item>
    <DropdownMenu.Separator />
    <DropdownMenu.Item>
      <ActiveLink
        href={localizeHref("/settings")}
        className="flex items-center gap-2 w-full"
        shouldHaveActiveState={false}
      >
        <span>
          <svg
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z"
              stroke="black"
              stroke-width="1.4"
            />
            <path
              d="M13.765 2.152C13.398 2 12.932 2 12 2C11.068 2 10.602 2 10.235 2.152C9.99214 2.25251 9.77151 2.3999 9.58569 2.58572C9.39986 2.77155 9.25248 2.99218 9.15196 3.235C9.05996 3.458 9.02296 3.719 9.00896 4.098C9.00245 4.37193 8.92657 4.63973 8.7884 4.87635C8.65024 5.11298 8.45432 5.31069 8.21896 5.451C7.97977 5.58477 7.71055 5.65567 7.43649 5.65707C7.16244 5.65847 6.89251 5.59032 6.65196 5.459C6.31596 5.281 6.07296 5.183 5.83196 5.151C5.30628 5.08187 4.77466 5.22431 4.35396 5.547C4.03996 5.79 3.80596 6.193 3.33996 7C2.87396 7.807 2.63996 8.21 2.58896 8.605C2.5546 8.86545 2.57188 9.13012 2.63983 9.38389C2.70778 9.63767 2.82505 9.87556 2.98496 10.084C3.13296 10.276 3.33996 10.437 3.66096 10.639C4.13396 10.936 4.43796 11.442 4.43796 12C4.43796 12.558 4.13396 13.064 3.66096 13.36C3.33996 13.563 3.13196 13.724 2.98496 13.916C2.82505 14.1244 2.70778 14.3623 2.63983 14.6161C2.57188 14.8699 2.5546 15.1345 2.58896 15.395C2.64096 15.789 2.87396 16.193 3.33896 17C3.80596 17.807 4.03896 18.21 4.35396 18.453C4.5624 18.6129 4.8003 18.7302 5.05407 18.7981C5.30784 18.8661 5.57251 18.8834 5.83296 18.849C6.07296 18.817 6.31596 18.719 6.65196 18.541C6.89251 18.4097 7.16244 18.3415 7.43649 18.3429C7.71055 18.3443 7.97977 18.4152 8.21896 18.549C8.70196 18.829 8.98896 19.344 9.00896 19.902C9.02296 20.282 9.05896 20.542 9.15196 20.765C9.25248 21.0078 9.39986 21.2284 9.58569 21.4143C9.77151 21.6001 9.99214 21.7475 10.235 21.848C10.602 22 11.068 22 12 22C12.932 22 13.398 22 13.765 21.848C14.0078 21.7475 14.2284 21.6001 14.4142 21.4143C14.6001 21.2284 14.7474 21.0078 14.848 20.765C14.94 20.542 14.977 20.282 14.991 19.902C15.011 19.344 15.298 18.828 15.781 18.549C16.0202 18.4152 16.2894 18.3443 16.5634 18.3429C16.8375 18.3415 17.1074 18.4097 17.348 18.541C17.684 18.719 17.927 18.817 18.167 18.849C18.4274 18.8834 18.6921 18.8661 18.9459 18.7981C19.1996 18.7302 19.4375 18.6129 19.646 18.453C19.961 18.211 20.194 17.807 20.66 17C21.126 16.193 21.36 15.79 21.411 15.395C21.4453 15.1345 21.428 14.8699 21.3601 14.6161C21.2921 14.3623 21.1749 14.1244 21.015 13.916C20.867 13.724 20.66 13.563 20.339 13.361C20.1049 13.2184 19.9108 13.0187 19.7749 12.7807C19.639 12.5427 19.5658 12.2741 19.562 12C19.562 11.442 19.866 10.936 20.339 10.64C20.66 10.437 20.868 10.276 21.015 10.084C21.1749 9.87556 21.2921 9.63767 21.3601 9.38389C21.428 9.13012 21.4453 8.86545 21.411 8.605C21.359 8.211 21.126 7.807 20.661 7C20.194 6.193 19.961 5.79 19.646 5.547C19.4375 5.38709 19.1996 5.26981 18.9459 5.20187C18.6921 5.13392 18.4274 5.11664 18.167 5.151C17.927 5.183 17.684 5.281 17.347 5.459C17.1065 5.59014 16.8368 5.6582 16.5629 5.6568C16.2891 5.6554 16.02 5.58459 15.781 5.451C15.5456 5.31069 15.3497 5.11298 15.2115 4.87635C15.0734 4.63973 14.9975 4.37193 14.991 4.098C14.977 3.718 14.941 3.458 14.848 3.235C14.7474 2.99218 14.6001 2.77155 14.4142 2.58572C14.2284 2.3999 14.0078 2.25251 13.765 2.152Z"
              stroke="black"
              stroke-width="1.4"
            />
          </svg>
        </span>
        {m.navbar_settings()}</ActiveLink
      >
    </DropdownMenu.Item>
    <DropdownMenu.Separator />
    <DropdownMenu.Item>
      <ActiveLink
        href={localizeHref("/account/sign_out")}
        className="flex items-center gap-2 w-full"
        shouldHaveActiveState={false}
      >
        <span>
          <svg
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <g clip-path="url(#clip0_618_4154)">
              <path
                d="M10.24 0C13.385 0 16.297 1.395 18.228 3.744C18.283 3.81059 18.3241 3.88756 18.3487 3.97033C18.3734 4.05311 18.3811 4.14 18.3715 4.22583C18.3619 4.31167 18.3351 4.39469 18.2928 4.46997C18.2504 4.54524 18.1934 4.61123 18.125 4.664C17.9858 4.7731 17.8096 4.82368 17.6337 4.80501C17.4579 4.78634 17.2962 4.69989 17.183 4.564C16.3387 3.54117 15.2778 2.71854 14.077 2.15547C12.8761 1.59241 11.5653 1.30295 10.239 1.308C5.324 1.308 1.339 5.2 1.339 10C1.339 14.8 5.324 18.692 10.239 18.692C11.5844 18.6973 12.9137 18.3995 14.1283 17.8208C15.3429 17.2421 16.4116 16.3972 17.255 15.349C17.3663 15.2117 17.5266 15.1231 17.7021 15.102C17.8776 15.0809 18.0544 15.129 18.195 15.236C18.264 15.2879 18.3218 15.3531 18.3651 15.4277C18.4084 15.5024 18.4362 15.585 18.4469 15.6706C18.4577 15.7563 18.4511 15.8432 18.4275 15.9262C18.404 16.0093 18.364 16.0867 18.31 16.154C16.382 18.564 13.431 20 10.24 20C4.583 20 0 15.523 0 10C0 4.477 4.584 0 10.24 0ZM17.098 7.16L19.804 9.867C20.066 10.128 20.071 10.547 19.816 10.803L17.172 13.446C17.11 13.507 17.0366 13.5552 16.9559 13.5877C16.8752 13.6203 16.7889 13.6366 16.7019 13.6356C16.6149 13.6347 16.529 13.6166 16.449 13.5823C16.3691 13.5481 16.2967 13.4983 16.236 13.436C16.1734 13.3754 16.1235 13.303 16.0891 13.223C16.0546 13.1429 16.0364 13.0569 16.0354 12.9698C16.0343 12.8827 16.0506 12.7962 16.0831 12.7154C16.1157 12.6346 16.1639 12.5611 16.225 12.499L17.772 10.952H7.462C7.37499 10.9533 7.28858 10.9374 7.20774 10.9052C7.1269 10.873 7.05323 10.8252 6.99096 10.7644C6.92869 10.7036 6.87905 10.6311 6.84491 10.5511C6.81076 10.471 6.79278 10.385 6.792 10.298C6.792 9.936 7.092 9.643 7.462 9.643H17.731L16.173 8.085C16.1106 8.02439 16.0608 7.95205 16.0264 7.87212C15.9921 7.7922 15.9739 7.70627 15.9729 7.61929C15.9718 7.5323 15.988 7.44597 16.0205 7.36526C16.0529 7.28455 16.101 7.21106 16.162 7.149C16.2241 7.08804 16.2976 7.03994 16.3783 7.00748C16.459 6.97502 16.5453 6.95884 16.6323 6.95986C16.7193 6.96088 16.8052 6.97909 16.8851 7.01344C16.965 7.04778 17.0374 7.09759 17.098 7.16Z"
                fill="black"
              />
            </g>
            <defs>
              <clipPath id="clip0_618_4154">
                <rect width="20" height="20" fill="white" />
              </clipPath>
            </defs>
          </svg>
        </span>
        {m.navbar_logout()}</ActiveLink
      >
    </DropdownMenu.Item>
  </DropdownMenu.Content>
</DropdownMenu.Root>
